{"version":3,"sources":["webpack:///./components/Error_MSG/style.css","webpack:///./routes/menus/style.css","webpack:///./routes/menus/index.js","webpack:///./components/Error_MSG/index.js"],"names":["Menus","useState","buttonLoading","setButtonLoading","error","msg","menusError","setMenusError","useEffect","window","chrome","tabs","onUpdated","addListener","tabId","changeInfo","url","test","route","getActiveTab","query","active","currentWindow","executeScript","scripting","target","id","files","class","style","body","bottom","actions","disabled","loading","onClick","then","tab","regex","includes","origin","exec","cookie_prepared","cookies","getAll","domain","map","i","name","value","join","sendMessage","type","cookiesData","setTimeout","height","width","fill","xmlns","viewBox","x","y","d","label","ball_pulse","Error_MSG","result","version"],"mappings":"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","file":"route-menus.chunk.852f7.js","sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"error\":\"error__20fDc\",\"active\":\"active__12abY\"};","// extracted by mini-css-extract-plugin\nexport default {\"body\":\"body__28cpj\",\"hidden\":\"hidden__sdgiS\",\"color\":\"color__12Tjx\",\"warning\":\"warning__2T6QD\",\"error\":\"error__1pqeM\",\"is-active\":\"is-active__1YoAu\",\"input\":\"input__236nG\",\"actions\":\"actions__1pcir\",\"file-upload\":\"file-upload__2aKSN\",\"footer\":\"footer__bwli3\",\"disabled\":\"disabled__3SKID\",\"loading\":\"loading__2MfcM\",\"label\":\"label__2w5DN\",\"ball_pulse\":\"ball_pulse__3y8Xg\",\"icon\":\"icon__138k1\",\"error_icon\":\"error_icon__OvhGZ\",\"scale\":\"scale__2Ykl1\"};","import { h } from 'preact';\nimport { useEffect, useState } from 'preact/hooks';\nimport { route } from 'preact-router';\n\nimport { AuthContext } from \"../../components/Auth\";\nimport Error_MSG from '../../components/Error_MSG';\nimport style from './style.css';\n\nconst Menus = () => {\n  // const { currentUser } = useContext(AuthContext);\n  const [buttonLoading, setButtonLoading] = useState(false);\n  const [menusError, setMenusError] = useState({\n      error: false,\n      msg: \"\"\n  });\n\n  useEffect(() => {\n    setMenusError({ error: false, msg: \"\" });\n    window.chrome.tabs.onUpdated.addListener((tabId, changeInfo) => {\n      if(changeInfo.url != null){\n        //console.log(`onUpdated. url is ${changeInfo.url}`);\n\n        const regex = /admin\\/menus\\/[0-9]+(\\?.*)?$/;\n        const regex1 = /store\\/.*\\/menus\\/[0-9]+(\\?.*)?$/;\n        const regex2 = /admin\\/menus\\/?(\\?.*)?$/;\n        const regex3 = /store\\/.*\\/menus\\/?(\\?.*)?$/;\n\n        if (regex.test(changeInfo.url) || regex1.test(changeInfo.url)) {\n          route('/menu');\n          return;\n        } else if (regex2.test(changeInfo.url) || regex3.test(changeInfo.url)) {\n          route('/menus');\n          return;\n        }\n      }\n    });\n  }, []);\n\n  const importHandler = () => {\n    setButtonLoading(true);\n    //console.log('%c[IMPORTING....]', 'color:black; background:yellow;');\n    \n    try {\n      return executeScript()\n      .then(getActiveTab)\n      .then(async (tab) => {\n        let regex = /https?:\\/\\/(.*\\.myshopify.com)\\/.*\\/menus\\/?/;\n\n        if (tab.url.includes(\"admin.shopify.com\")) {\n          regex = /https?:\\/\\/(admin.shopify.com)\\/store\\/.*\\/menus\\/?/;\n        }\n\n        const [, origin] = regex.exec(tab.url);\n        const cookies = await window.chrome.cookies.getAll({ domain: origin });\n        const cookie_prepared = cookies.map(i => `${i.name}=${i.value}`).join('; ');\n\n        window.chrome.tabs.sendMessage(\n          tab.id,\n          {\n            type: 'openPopup',\n            cookiesData: cookie_prepared\n          },\n          async () => {\n            setButtonLoading(false);\n          }\n        );\n      });\n    } catch (error) {\n      //console.log(error);\n      setButtonLoading(false);\n\n      setMenusError({ error: true, msg: 'Operation failed! please try again.' });\n      setTimeout(() => {\n        setMenusError({ error: true, msg: '' });\n      }, 20000);\n    }\n};\n\n  const getActiveTab = async () => {\n    const queryOptions = { active: true, currentWindow: true };\n    const [tab] = await window.chrome.tabs.query(queryOptions);\n\n    return tab;\n  };\n\n  const executeScript = async () => {\n    const queryOptions = { active: true, currentWindow: true };\n    const [tab] = await window.chrome.tabs.query(queryOptions);\n    \n    window.chrome.scripting.executeScript({\n      target: { tabId: tab.id },\n      files: ['contentScript.js']\n    });\n  };\n\n\treturn (\n\t\t<div class={style.body}>\n      <h2>Shopify Navigation Tool</h2>\n      <h5>An absolute time saver</h5>\n\n      <h4 class={style.bottom}>Actions</h4>\n      <div class={`${style.actions} ${buttonLoading ? style.disabled : \"\"}`}>\n        <button\n          class={`${buttonLoading ? style.loading : \"\"}`}\n          onClick={importHandler}\n        >\n          <svg\n            height=\"16px\"\n            width=\"16px\"\n            fill=\"#000000\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            viewBox=\"0 0 64 64\"\n            x=\"0px\"\n            y=\"0px\"\n          >\n            <title>Import</title>\n            <g>\n              <path d=\"M9.315,14.227a1,1,0,0,1,1-1h8.658A17.4,17.4,0,0,1,36.35,30.6v5.987l5.723-5.723a1,1,0,1,1,1.414,1.414l-7.43,7.429a1,1,0,0,1-.325.217.986.986,0,0,1-.764,0,.99.99,0,0,1-.326-.217l-7.429-7.429a1,1,0,0,1,1.414-1.414l5.723,5.723V30.6A15.4,15.4,0,0,0,18.973,15.227H10.315A1,1,0,0,1,9.315,14.227Zm37.37-1H39.35a1,1,0,0,0,0,2h7.335a6.007,6.007,0,0,1,6,6V42.773a6.007,6.007,0,0,1-6,6H17.315a6.007,6.007,0,0,1-6-6V24.16a1,1,0,0,0-2,0V42.773a8.009,8.009,0,0,0,8,8h29.37a8.009,8.009,0,0,0,8-8V21.227A8.009,8.009,0,0,0,46.685,13.227Z\" />\n            </g>\n          </svg>\n          <span class={style.label}>Import</span>\n          <span class={style.ball_pulse}>\n            <span />\n            <span />\n            <span />\n          </span>\n        </button>\n      </div>\n      <Error_MSG result={menusError} />\n\t\t</div>\n\t);\n}\n\nexport default Menus;\n","import style from './style.css';\n\nexport default function Error_MSG({ result }) {\n  return (\n    <div class={`${style.error} ${result.error ? style.active: ''}`}>\n      <svg\n        height=\"16\"\n        width=\"16\"\n        fill=\"#F00\"\n        version=\"1.1\"\n        x=\"0px\"\n        y=\"0px\"\n        viewBox=\"0 0 100 100\"\n      >\n        <switch>\n          <g>\n            <path d=\"M24.6,64.8c0,0.5,0.2,1.1,0.6,1.4l8.6,8.6c0.8,0.8,2.1,0.8,2.9,0L50,61.4l13.4,13.4c0.4,0.4,0.9,0.6,1.4,0.6     c0.5,0,1-0.2,1.4-0.6l8.6-8.6c0.4-0.4,0.6-0.9,0.6-1.4s-0.2-1.1-0.6-1.4L61.4,50l13.4-13.4c0.4-0.4,0.6-0.9,0.6-1.4     s-0.2-1.1-0.6-1.4l-8.6-8.6c-0.8-0.8-2.1-0.8-2.9,0L50,38.6L36.6,25.2c-0.8-0.8-2.1-0.8-2.9,0l-8.6,8.6c-0.4,0.4-0.6,0.9-0.6,1.4     s0.2,1.1,0.6,1.4L38.6,50L25.2,63.4C24.8,63.8,24.6,64.3,24.6,64.8z M42.9,51.4c0.8-0.8,0.8-2.1,0-2.9L29.5,35.2l5.7-5.7     l13.4,13.4c0.8,0.8,2.1,0.8,2.9,0l13.4-13.4l5.7,5.7L57.1,48.6c-0.8,0.8-0.8,2.1,0,2.9l13.4,13.4l-5.7,5.7L51.4,57.1     c-0.4-0.4-0.9-0.6-1.4-0.6s-1.1,0.2-1.4,0.6L35.2,70.5l-5.7-5.7L42.9,51.4z\" />\n            <path d=\"M95.5,2.5h-91c-1.1,0-2,0.9-2,2v91c0,1.1,0.9,2,2,2h91c1.1,0,2-0.9,2-2v-91C97.5,3.4,96.6,2.5,95.5,2.5z M93.5,93.5H6.5     V6.5h86.9V93.5z\" />\n          </g>\n        </switch>\n      </svg>\n      <p>{result.msg}</p>\n    </div>\n  )\n}"],"sourceRoot":""}